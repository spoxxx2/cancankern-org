<!DOCTYPE html>
<html>
<head>
    <title>CanCan Pilot Program 2</title>
    <style>
        body { background: #050505; color: #00ff41; font-family: 'Courier New', monospace; padding: 20px; display: flex; gap: 20px; }
        .panel { flex: 1; border: 2px solid #00ff41; padding: 20px; background: #000; box-shadow: 0 0 15px #00ff41; }
        .funding { width: 350px; border-radius: 8px; overflow: hidden; }
        .progress-container { margin: 20px 0; background: #111; border: 1px solid #00ff41; height: 30px; }
        .progress-fill { background: #00ff41; height: 100%; width: 0%; transition: width 1s; }
        .hash-tag { font-size: 0.7em; color: #008f11; word-break: break-all; }
        .sector-tag { color: #ff00ff; font-weight: bold; }
        button { background: #00ff41; color: #000; border: none; padding: 15px; font-weight: bold; width: 100%; cursor: pointer; }
    </style>
</head>
<body>
    <div class="panel">
        <h2>[CAN-CAN] BAKERSFIELD FIELD OPS</h2>
        <div class="progress-container"><div id="fill" class="progress-fill"></div></div>
        <p>PILOT GOAL: <span id="val">$0.00</span> / $25,000.00</p>
        
        <hr color="#00ff41">
        <input type="file" id="up" multiple>
        <button onclick="scan()">START BATCH SCAN</button>

        <div id="status" style="margin-top:10px;">> System Ready.</div>
        
        <div style="margin-top:20px; font-size:0.8em; border: 1px solid #444; padding: 10px;">
            <strong>TOUR SUGGESTION:</strong> <span class="sector-tag">SECTOR A (Industrial)</span><br>
            Target: Soiled Cellulose for Methane Credits.
        </div>
    </div>

    <div class="funding">
        <script type="module" src="https://donorbox.org/widgets.js" async></script>
        <dbox-widget campaign="cancan-pilot-program-2" type="donation_form"></dbox-widget>
    </div>

    <script>
    let total = 0;
    async function scan() {
        const files = document.getElementById('up').files;
        const fd = new FormData();
        for(let f of files) { fd.append('files', f); }
        fd.append('humidity', '89');

        const res = await fetch('http://localhost:8000/batch-scan', {method:'POST', body:fd});
        const data = await res.json();
        
        total += parseFloat(data.total_credits.replace('$',''));
        document.getElementById('val').innerText = `$${total.toFixed(2)}`;
        document.getElementById('fill').style.width = (total/25000*100) + '%';
        document.getElementById('status').innerHTML = `> HASH: <span class="hash-tag">${data.top_hash}</span><br>> STATUS: ${data.registry_status}`;
    }
    </script>
</body>
</html>
